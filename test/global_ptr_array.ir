# test=harness 6

$gi = i4 { 0 }

$gp = i4* { 0 }
$gbuf = [i4 x 4]

$g = void (i4* $p)
{
	store $p, i4 3
	ret void
}

$test = i4 ()
{
	$local = alloca i4*

	store $gp, $gi

	$1 = load $gp
	store $local, $1

	$arg1 = load $local
	call $g($arg1)

# $gi now contains 3

	$2 = elem $gbuf, i1 0
	store $local, $2

	$arg2 = load $local
	call $g($arg2)

# $gbuf[0] contains 3

	$a = load $gi
	$b = load $2
	$c = add $a, $b
	ret $c
}
